<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nomenclature App</title>
  <link rel="stylesheet" href="/PracticingChemistry/css/style.css" />
  <style>
    /* Multi-column functional group checkboxes */
    .functional-group-checkboxes {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
      gap: 0.5em 2em;
      margin-bottom: 0.5em;
    }
    /* Make the main content area wider */
    main {
      min-width: 80vw;
      width: 80vw !important;
      max-width: 1200px;
    }
    @media (max-width: 900px) {
      main {
        min-width: 98vw;
        width: 98vw !important;
      }
      .functional-group-checkboxes {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      }
    }
    @media (max-width: 600px) {
      main {
        min-width: 100vw;
        width: 100vw !important;
        padding-left: 0.5vw;
        padding-right: 0.5vw;
      }
      .functional-group-checkboxes {
        grid-template-columns: 1fr;
      }
    }
    .select-deselect-btns {
      margin-bottom: 0.5em;
    }
  </style>
</head>
<body>
  <header>
    <h1>Nomenclature App</h1>
    <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
  </header>
  <nav>
    <a href="../../GeneralChemistry/index.html">General Chemistry</a>
    <div class="dropdown">
      <a href="#">Organic Chemistry</a>
      <div class="dropdown-content">
        <a href="../SynthesisApp/index.html">Synthesis App</a>
        <a href="../NomenclatureApp/index.html">Nomenclature App</a>
      </div>
    </div>
  </nav>
  <main>
    <section id="settings-panel-section">
      <button id="settings-toggle-button" type="button" aria-expanded="false" aria-controls="settings-panel" style="margin-bottom: 0.5rem;">
        Show Settings
      </button>
      <div id="settings-panel" style="display:none;">
        <h2>Settings</h2>
        <form id="settings-form" autocomplete="off">
          <div class="toggle-container">
            <span class="toggle-label">Common vs. IUPAC Nomenclature</span>
            <div class="toggle-switch" id="common-iupac-toggle" onclick="toggleSwitch('common-iupac-toggle')"></div>
          </div>
          <div class="toggle-container">
            <span class="toggle-label" id="image-name-toggle-label">Molecule Image</span>
            <div class="toggle-switch" id="image-name-toggle" tabindex="0" role="button" aria-pressed="false" aria-label="Toggle between image and name"></div>
          </div>
          <label>
            Minimum Carbons:
            <input type="number" id="min-carbons" min="1" max="11" step="1" value="1" required aria-label="Minimum Carbons" />
          </label>
          <label>
            Maximum Carbons:
            <input type="number" id="max-carbons" min="2" max="12" step="1" value="7" required aria-label="Maximum Carbons" />
          </label>
          <div style="margin-bottom:0.5em;">
            <span id="carbon-range-error" style="color:red;display:none;"></span>
          </div>
          <fieldset>
            <legend>Functional Groups</legend>
            <div class="select-deselect-btns">
              <button type="button" id="select-all-fg-btn">Select All</button>
              <button type="button" id="deselect-all-fg-btn">Deselect All</button>
            </div>
            <div class="functional-group-checkboxes">
              <label><input type="checkbox" name="functional-group" value="alkyl" checked /> Alkyl (–R)</label>
              <label><input type="checkbox" name="functional-group" value="halide" checked /> Halide (–X)</label>
              <label><input type="checkbox" name="functional-group" value="alcohol" checked /> Alcohol (–OH)</label>
              <label><input type="checkbox" name="functional-group" value="ketone" checked /> Ketone</label>
              <label><input type="checkbox" name="functional-group" value="aldehyde" checked /> Aldehyde</label>
              <label><input type="checkbox" name="functional-group" value="carboxylic-acid" checked /> Carboxylic Acid</label>
              <label><input type="checkbox" name="functional-group" value="amino" /> Amino (–NH₂)</label>
              <label><input type="checkbox" name="functional-group" value="ester" /> Ester (–COO–)</label>
              <label><input type="checkbox" name="functional-group" value="amide" /> Amide (–CONH₂)</label>
              <label><input type="checkbox" name="functional-group" value="nitrile" /> Nitrile (–C≡N)</label>
              <label><input type="checkbox" name="functional-group" value="ether" /> Ether (–O–)</label>
              <label><input type="checkbox" name="functional-group" value="thiol" /> Thiol (–SH)</label>
              <label><input type="checkbox" name="functional-group" value="aromatic" /> Aromatic Groups</label>
              <label><input type="checkbox" name="functional-group" value="alkyl-halide" /> Alkyl Halide</label>
            </div>
          </fieldset>
        </form>
      </div>
    </section>
    <button id="new-problem-button">New Problem</button>
    <button id="check-problem-button" style="display: none;">Check Problem</button>
    <section id="problem-display">
      <h2>Problem</h2>
      <p id="problem-content"></p>
    </section>
    <section id="answer-display" style="display: none;">
      <h2>Answer</h2>
      <p id="answer-content"></p>
    </section>
  </main>
  <footer>
    <p>&copy; 2025 Practicing Chemistry. All rights reserved. </p>
    <p>Version 1.024</p>
  </footer>
  <script src="nomenclature-app.js"></script>
  <script>
    // Collapsible settings panel logic
    const toggleButton = document.getElementById('settings-toggle-button');
    const settingsPanel = document.getElementById('settings-panel');
    toggleButton.addEventListener('click', () => {
      const isHidden = settingsPanel.style.display === "none";
      settingsPanel.style.display = isHidden ? "block" : "none";
      toggleButton.textContent = isHidden ? "Hide Settings" : "Show Settings";
      toggleButton.setAttribute('aria-expanded', isHidden ? "true" : "false");
    });

    // Set default functional group checkboxes (in case page is reloaded and browser doesn't preserve state)
    window.addEventListener('DOMContentLoaded', () => {
      [
        "alkyl",
        "halide",
        "alcohol",
        "ketone",
        "aldehyde",
        "carboxylic-acid"
      ].forEach(val => {
        const box = document.querySelector('input[type="checkbox"][value="'+val+'"]');
        if (box) box.checked = true;
      });
    });

    // Carbon range form validation logic
    const minCarbonsInput = document.getElementById('min-carbons');
    const maxCarbonsInput = document.getElementById('max-carbons');
    const errorSpan = document.getElementById('carbon-range-error');

    function validateCarbons() {
      let min = parseInt(minCarbonsInput.value, 10);
      let max = parseInt(maxCarbonsInput.value, 10);

      if (isNaN(min) || min < 1) min = 1;
      if (min > 11) min = 11;
      if (isNaN(max) || max < 2) max = 2;
      if (max > 12) max = 12;

      if (min > max) {
        min = max;
      }
      if (min > 11) min = 11;
      if (max < 2) max = 2;

      minCarbonsInput.value = min;
      maxCarbonsInput.value = max;

      if (min > max) {
        errorSpan.style.display = '';
        errorSpan.textContent = "Minimum carbons must be less than or equal to maximum.";
        return false;
      } else {
        errorSpan.style.display = 'none';
        errorSpan.textContent = "";
        return true;
      }
    }

    minCarbonsInput.addEventListener('input', validateCarbons);
    maxCarbonsInput.addEventListener('input', validateCarbons);
    document.getElementById('settings-form').addEventListener('submit', e => e.preventDefault());

    // Select/Deselect All Buttons
    document.getElementById('select-all-fg-btn').addEventListener('click', function() {
      document.querySelectorAll('input[type="checkbox"][name="functional-group"]').forEach(cb => cb.checked = true);
    });
    document.getElementById('deselect-all-fg-btn').addEventListener('click', function() {
      document.querySelectorAll('input[type="checkbox"][name="functional-group"]').forEach(cb => cb.checked = false);
    });
  </script>
</body>
</html>